다 적고 보니 남이보기엔 너무나도 구성도 가독성도 좋지 못하니 안읽는걸 추천합니다.

# 막스킴 센세의 종강시계만들기

사건 발생 : 종혁이형이 종강시계를 만들었다. 그이후 한결이가만들었다. 고로 나도만든다.

- [맥스좌 종강시계 레포](https://github.com/MaxKim-J/HUFS-Semester-Clock-Extension)
- [늘한좌 종강시계 레포](https://github.com/Neulhan/HYClock)

못만들지도 모름..아무것도 무턱대고 시작하는 플젝으로 크기는 작지만 나한테는 크고 절벽같은느낌이다.

## 프로젝트 구성

일단 맥스좌는 Vue기반의 vue-web-extension을 보일러플레이트로 만들었다. 한결좌는 장고로만든거같은데 뭐지 장고템플릿인가?? 모르겠다. 나는 리액트로 만들어볼 생각이다.

일단 오늘은 간단히 어떻게 만들지 분석정도만 시도 해본다.

- react.js
- chrome storage api(참고 : https://ohgyun.com/548)
- firebase

프론트 프레임워크만다르지 구성은 막스좌와 똑같다. 크롬 storage api를 사용시 크롬간 동기화가 가능하고 리덕스와 연결하는 오픈소스가 있는걸로보와 가능할듯 하다. 파이어베이스도 같은 방향으로 진행하며 기능적으로 조금 다르게 들어갈듯하다.

## 기능

- 종강시계인만큼 종강까지의 날자와 시간을 보여준다.
- 투두리스트를 넣을 예정이다.
  - 요즘 아이패드에서도 투두리스트를 손으로 써가며 사용하시는 분들이 많던데 일반적인 투두리스트로할지 트렐로와같은 블럭단위의 아키이빙을 가져다 쓸지 고민좀 해보려한다.
- 우리학교엔 메인페이지 말고도 여러가지 연결되는 다른종류의 사이트들이 생각보다 많다. 이거 정리해서 올려둘 예정

## 다짐

분명 지켜지지 않겠지만 이번학기안에 끝내보는게 목표이고 우선순위는 학교 수업관련 프로젝트 이 후로 두며 최대한 열심히 해보겠다리..

---

(2021.07.22) 위의 다짐은 깔끔하게 날아갔고 약 1년이 약간 안되서야 다시 시작

## 사건의 발단

반년이 넘도록 일을 해보겠다고 개발조직에대한 구성이 1도없는 회사에서 반년동안 일하고 학교생활만 했다.(개발 외적으로 경험이 되었다아?)

무언가 새로운것을 배운다거나 자발적인 개발이 전혀 없던 기간이 지나고 '지금 뭐하고있지'와 같은 생각과 함께 다시 하고싶은걸 찾아다니다 여기로 돌아왔다.

### 해볼것

- cra가 아닌 바닥부터의 react, typescript, mobX로 chrome extention 제작
- 남설 종강 시계와 함께 간단히 오늘 할일정도 기록해둘 todolist 작성란을 만들 예정

#### 초기 세팅을 하면서 얻은 것

- 웹팩의 세부 설정 및 설정 별 기능

  - 웹팩파일에서 기본 설정 `webpack.config.js` 의 모습

    ```javascript
    const config = {
      output: {
        path: "바벨로 정리된 파일이 출력될 경로",
        filename: "[name].js", // 저장될 파일 명 [name]으로 설정 해두면 작성했던 파일 이름을 그대로 가져옴
      },
      context: path.resolve(__dirname, "../src"),
      resolve: {
        extensions: [".wasm", ".ts", ".tsx", ".mjs", ".cjs", ".js", ".json"], // import해올 때 확장자명 생략 가능
      },
      module: {
        rules: [
          {
            test: /\.(ts|tsx)$/, // 파일 형식
            use: {
              "여러가지 로더설정들"
            },
            },
          },
          {
            test: /\.(png|jpe?g|gif|woff|woff2|ttf|svg|ico)$/i,
            use: [
              {
                loader: "file-loader",
              },
            ],
          },
        ],
      },
      plugins: [
        new CleanWebpackPlugin({
          cleanStaleWebpackAssets: false,
        }),
        new HtmlWebpackPlugin({
          inject: true,
          template: "../src/tab/tab.html",
          filename: "tab/tab.html",
        }),
      ],
    };

    module.exports = config;
    ```

    웹팩 기본 구성 Entry, Output, Loader, Plugin, Mode가 정리된 [블로그](https://velog.io/@hih0327/Webpack-%EA%B8%B0%EC%B4%88)

  - 웹팩 분리

    - webpack.config.common.js
    - webpack.config.dev.js
    - webpack.config.prod.js

    이런식으로 분리해서 사용하더군요. mode에서 배포용과 개발용 설정에따라 빌드되는 속도와 여러가지 설정이 달라 분기해서 설정 하였다.

    dev에선 webpack-dev-server설정도 들어가고 리액트 hot

  - 참고
    - [웹팩 러닝가이드](https://yamoo9.gitbook.io/webpack/webpack/webpack-plugins/manage-env-variables)
    - [EJS](https://ejs.co/) : 결과적으로 사용하진 않았지만 종혁좌가 vue로 종강시계만들때 환경변수 값들을 html에 첨부하려고 사용한듯
    - [웹팩 공식문서](https://webpack.js.org)

- 바벨은 잘 만들어진 리액트용 라이브러리를 사용
- 타입스크립 바벨은 웹팩에서 적용
- CRA의 바벨, 웹팩 설정 확인하는 방법
  `npm run eject`로 해제시키고 확인가능 함 (한번 풀면 다시 못돌리니 조심)
- 왜그랬을까..
  webpack-dev-server를 구성 중 기존의 react에서 index.js파일을 프로젝트 폴더에 위치 시킨다. 하지만 이번에 크롬 익스텐션을 만들고 빌드된 html파일을 tab/tab.html로 변환하기위해 `webpack.config.common.js`에서

  ```javascript
  plugins: [
    new CleanWebpackPlugin(),
    new HtmlWebpackPlugin({
      inject: true,
      template: '../src/tab/tab.html', // CRA에서 '../public/index.html'
      filename: 'tab/tab.html', // CRA에서 '../index.html'
    }),
  ],
  ```

  이렇게 작성을 했었는데 이게 webpack-dev-server에서 기본적으로 최상위 루트에 index.html을 기본으로 인식하다보니 localhost에서 계속 찾지 못해 cannot get/이 떴고 해당부분을 고치기위해 `webpack.config.dev.js`에서

  ```javascript
  devServer: {
    ...
    historyApiFallback: {
      index: '/tab/tab.html',
    },
    ...
  },
  ```

  위 부분처럼 수정하였다. 기존엔 historyApiFallback : true 로 작성했는데 이게 기본값으로 index.html로 지정되어 계속 로컬호스트에서 가져오지 못했다..

  [스오플 햄..](https://stackoverflow.com/questions/31945763/how-to-tell-webpack-dev-server-to-serve-index-html-for-any-route)

#### 감사합니다.

- [막스킴의 리액트 보일러플레이트](https://github.com/MaxKim-J/react-boilerplate)
- https://sujinlee.me/webpack-react-tutorial/
